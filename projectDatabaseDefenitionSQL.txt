CREATE TABLE `booking`.`brokerAccount` ( `brokerAccountId` INT NOT NULL AUTO_INCREMENT , `username` VARCHAR(255) NOT NULL , `email` VARCHAR(255) NOT NULL , `password` VARCHAR(255) NOT NULL , PRIMARY KEY (`brokerAccountId`)) ENGINE = InnoDB;
CREATE TABLE `booking`.`hotel` ( `hotelId` INT NOT NULL AUTO_INCREMENT , `username` VARCHAR(255) NOT NULL , `email` VARCHAR(255) NOT NULL , `password` VARCHAR(255) NOT NULL , `name` VARCHAR(255) NOT NULL , `facilities` VARCHAR(1024) NOT NULL , `location` VARCHAR(255) NOT NULL , `avgStars` FLOAT NOT NULL , PRIMARY KEY (`hotelId`)) ENGINE = InnoDB;
CREATE TABLE `booking`.`suspendedHotelAccounts` ( `suspendedHotelId` INT NOT NULL , PRIMARY KEY (`suspendedHotelId`)) ENGINE = InnoDB;
CREATE TABLE `booking`.`premiumHotelAccounts` ( `premiumHotelId` INT NOT NULL , PRIMARY KEY (`premiumHotelId`)) ENGINE = InnoDB;
CREATE TABLE `booking`.`pendingHotelAccounts` ( `pendingHotelId` INT NOT NULL , PRIMARY KEY (`pendingHotelId`)) ENGINE = InnoDB;
ALTER TABLE `hotel` ADD `moneyDue` INT NOT NULL AFTER `avgStars`;
CREATE TABLE `booking`.`hoteImages` ( `imageId` INT NOT NULL AUTO_INCREMENT , `ownerHotelId` INT NOT NULL , `imageURL` VARCHAR(1024) NOT NULL , PRIMARY KEY (`imageId`)) ENGINE = InnoDB;
CREATE TABLE `booking`.`rooms` ( `roomId` INT NOT NULL AUTO_INCREMENT , `offeringHotelId` INT NOT NULL , `type` VARCHAR(255) NOT NULL , `price` INT NOT NULL , PRIMARY KEY (`roomId`)) ENGINE = InnoDB;
CREATE TABLE `booking`.`customer` ( `customerId` INT NOT NULL AUTO_INCREMENT , `username` VARCHAR(255) NOT NULL , `email` VARCHAR(255) NOT NULL , `password` VARCHAR(255) NOT NULL , `name` VARCHAR(255) NOT NULL , `numberOfReservationsMade` INT NOT NULL , PRIMARY KEY (`customerId`)) ENGINE = InnoDB;
CREATE TABLE `booking`.`ratings` ( `ratedHotelId` INT NOT NULL , `ratingCustomerId` INT NOT NULL , `ratingId` INT NOT NULL AUTO_INCREMENT , `numberOfStars` INT NOT NULL , `ratingText` VARCHAR(1024) NOT NULL , PRIMARY KEY (`ratingId`)) ENGINE = InnoDB;
CREATE TABLE `booking`.`suspendedCustomersAccounts` ( `suspendedCustomerId` INT NOT NULL , PRIMARY KEY (`suspendedCustomerId`)) ENGINE = InnoDB;
CREATE TABLE `booking`.`reservations` ( `reservationId` INT NOT NULL AUTO_INCREMENT , `customerId` INT NOT NULL , `hotelId` INT NOT NULL , `roomId` INT NOT NULL , `fromDate` DATE NOT NULL , `toDate` DATE NOT NULL , `totalPrice` INT NOT NULL , `isCancelled` BOOLEAN NOT NULL DEFAULT FALSE , `isApproved` BOOLEAN NOT NULL DEFAULT FALSE , PRIMARY KEY (`reservationId`)) ENGINE = InnoDB;
CREATE TABLE `booking`.`pendingReservation` ( `pendingReservationId` INT NOT NULL , PRIMARY KEY (`pendingReservationId`)) ENGINE = InnoDB;
CREATE TABLE `booking`.`checkIns` ( `checkInId` INT NOT NULL AUTO_INCREMENT , `reservationId` INT NOT NULL , `customerId` INT NOT NULL , `hotelId` INT NOT NULL , `checkInDate` DATE NOT NULL , `checkOutDate` DATE NOT NULL , `amountPayed` INT NOT NULL , PRIMARY KEY (`checkInId`)) ENGINE = InnoDB;
ALTER TABLE `suspendedHotelAccounts` ADD FOREIGN KEY (`suspendedHotelId`) REFERENCES `hotel`(`hotelId`) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE `premiumHotelAccounts` ADD FOREIGN KEY (`premiumHotelId`) REFERENCES `hotel`(`hotelId`) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE `pendingHotelAccounts` ADD FOREIGN KEY (`pendingHotelId`) REFERENCES `hotel`(`hotelId`) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE `hoteImages` ADD FOREIGN KEY (`ownerHotelId`) REFERENCES `hotel`(`hotelId`) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE `rooms` ADD FOREIGN KEY (`offeringHotelId`) REFERENCES `hotel`(`hotelId`) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE `ratings` ADD FOREIGN KEY (`ratedHotelId`) REFERENCES `hotel`(`hotelId`) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE `ratings` ADD FOREIGN KEY (`ratingCustomerId`) REFERENCES `customer`(`customerId`) ON DELETE CASCADE ON UPDATE RESTRICT;
ALTER TABLE `suspendedCustomersAccounts` ADD FOREIGN KEY (`suspendedCustomerId`) REFERENCES `customer`(`customerId`) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE `reservations` ADD FOREIGN KEY (`customerId`) REFERENCES `customer`(`customerId`) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE `reservations` ADD FOREIGN KEY (`roomId`) REFERENCES `rooms`(`roomId`) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE `reservations` ADD FOREIGN KEY (`hotelId`) REFERENCES `hotel`(`hotelId`) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE `pendingReservation` ADD FOREIGN KEY (`pendingReservationId`) REFERENCES `reservations`(`reservationId`) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE `checkIns` ADD FOREIGN KEY (`reservationId`) REFERENCES `reservations`(`reservationId`) ON DELETE CASCADE ON UPDATE CASCADE; 
ALTER TABLE `checkIns` ADD FOREIGN KEY (`customerId`) REFERENCES `customer`(`customerId`) ON DELETE CASCADE ON UPDATE CASCADE; 
ALTER TABLE `checkIns` ADD FOREIGN KEY (`hotelId`) REFERENCES `hotel`(`hotelId`) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE `brokerAccount` ADD UNIQUE(`username`);
ALTER TABLE `brokerAccount` ADD UNIQUE(`email`);
ALTER TABLE `customer` ADD UNIQUE(`username`);
ALTER TABLE `customer` ADD UNIQUE(`email`);
ALTER TABLE `hotel` ADD UNIQUE(`username`);
ALTER TABLE `hotel` ADD UNIQUE(`email`);
ALTER TABLE `hotel` CHANGE `avgStars` `avgRating` FLOAT NOT NULL DEFAULT '0';
ALTER TABLE `hotel` ADD `stars` INT NOT NULL AFTER `moneyDue`;
ALTER TABLE `customer` CHANGE `numberOfReservationsMade` `numberOfReservationsMade` INT(11) NOT NULL DEFAULT '0';
ALTER TABLE `suspendedCustomersAccounts` ADD `suspensionDate` DATE NOT NULL AFTER `suspendedCustomerId`;
ALTER TABLE `hotel` CHANGE `moneyDue` `moneyDue` INT(11) NOT NULL DEFAULT '0';
CREATE TABLE `booking`.`hotelFacilities` ( `hotelID` INT NOT NULL , `facility` VARCHAR(255) NOT NULL ) ENGINE = InnoDB;
ALTER TABLE `hotelFacilities` ADD FOREIGN KEY (`hotelID`) REFERENCES `hotel`(`hotelId`) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE `reservations` ADD `extensionDummy` BOOLEAN NOT NULL DEFAULT FALSE AFTER `isApproved`;
